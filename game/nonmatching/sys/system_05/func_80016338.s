.section .text
glabel func_80016338
  /* 016F38 80016338 27BDFFD0 */     addiu $sp, $sp, -0x30
  /* 016F3C 8001633C AFBF0014 */        sw $ra, 0x14($sp)
  /* 016F40 80016340 AFA40030 */        sw $a0, 0x30($sp)
  /* 016F44 80016344 AFA50034 */        sw $a1, 0x34($sp)
  /* 016F48 80016348 AFA60038 */        sw $a2, 0x38($sp)
  /* 016F4C 8001634C 10C00004 */      beqz $a2, .L80016360
  /* 016F50 80016350 8C830000 */        lw $v1, ($a0)
  /* 016F54 80016354 24010001 */     addiu $at, $zero, 1
  /* 016F58 80016358 54C10010 */      bnel $a2, $at, .L8001639C
  /* 016F5C 8001635C 3C19DC08 */       lui $t9, 0xdc08
  .L80016360:
  /* 016F60 80016360 8FB80034 */        lw $t8, 0x34($sp)
  /* 016F64 80016364 8FA40030 */        lw $a0, 0x30($sp)
  /* 016F68 80016368 3C058004 */       lui $a1, %hi(D_80046626)
  /* 016F6C 8001636C 8F190080 */        lw $t9, 0x80($t8)
  /* 016F70 80016370 332E0020 */      andi $t6, $t9, 0x20
  /* 016F74 80016374 51C00009 */      beql $t6, $zero, .L8001639C
  /* 016F78 80016378 3C19DC08 */       lui $t9, 0xdc08
  /* 016F7C 8001637C 0C0014D1 */       jal append_ucode_load
  /* 016F80 80016380 94A56626 */       lhu $a1, %lo(D_80046626)($a1)
  /* 016F84 80016384 8FB80030 */        lw $t8, 0x30($sp)
  /* 016F88 80016388 240F0001 */     addiu $t7, $zero, 1
  /* 016F8C 8001638C 3C018004 */       lui $at, %hi(D_80046628)
  /* 016F90 80016390 A42F6628 */        sh $t7, %lo(D_80046628)($at)
  /* 016F94 80016394 8F030000 */        lw $v1, ($t8)
  /* 016F98 80016398 3C19DC08 */       lui $t9, (0xDC080008 >> 16) # 3691511816
  .L8001639C:
  /* 016F9C 8001639C 37390008 */       ori $t9, $t9, (0xDC080008 & 0xFFFF) # 3691511816
  /* 016FA0 800163A0 00602025 */        or $a0, $v1, $zero
  /* 016FA4 800163A4 AC990000 */        sw $t9, ($a0)
  /* 016FA8 800163A8 8FA20034 */        lw $v0, 0x34($sp)
  /* 016FAC 800163AC 3C098004 */       lui $t1, %hi(gCurrScreenWidth)
  /* 016FB0 800163B0 3C0F8004 */       lui $t7, %hi(D_8003B938)
  /* 016FB4 800163B4 24420008 */     addiu $v0, $v0, 8
  /* 016FB8 800163B8 AC820004 */        sw $v0, 4($a0)
  /* 016FBC 800163BC 84450008 */        lh $a1, 8($v0)
  /* 016FC0 800163C0 84460000 */        lh $a2, ($v0)
  /* 016FC4 800163C4 8447000A */        lh $a3, 0xa($v0)
  /* 016FC8 800163C8 84480002 */        lh $t0, 2($v0)
  /* 016FCC 800163CC 8D296678 */        lw $t1, %lo(gCurrScreenWidth)($t1)
  /* 016FD0 800163D0 8DEFB938 */        lw $t7, %lo(D_8003B938)($t7)
  /* 016FD4 800163D4 24630008 */     addiu $v1, $v1, 8
  /* 016FD8 800163D8 04A10002 */      bgez $a1, .L800163E4
  /* 016FDC 800163DC 00A00821 */      addu $at, $a1, $zero
  /* 016FE0 800163E0 24A10003 */     addiu $at, $a1, 3
  .L800163E4:
  /* 016FE4 800163E4 00012883 */       sra $a1, $at, 2
  /* 016FE8 800163E8 04C10002 */      bgez $a2, .L800163F4
  /* 016FEC 800163EC 00C00821 */      addu $at, $a2, $zero
  /* 016FF0 800163F0 24C10003 */     addiu $at, $a2, 3
  .L800163F4:
  /* 016FF4 800163F4 00013083 */       sra $a2, $at, 2
  /* 016FF8 800163F8 00A66023 */      subu $t4, $a1, $a2
  /* 016FFC 800163FC 04E10002 */      bgez $a3, .L80016408
  /* 017000 80016400 00E00821 */      addu $at, $a3, $zero
  /* 017004 80016404 24E10003 */     addiu $at, $a3, 3
  .L80016408:
  /* 017008 80016408 00013883 */       sra $a3, $at, 2
  /* 01700C 8001640C 05010002 */      bgez $t0, .L80016418
  /* 017010 80016410 01000821 */      addu $at, $t0, $zero
  /* 017014 80016414 25010003 */     addiu $at, $t0, 3
  .L80016418:
  /* 017018 80016418 00014083 */       sra $t0, $at, 2
  /* 01701C 8001641C 24010140 */     addiu $at, $zero, 0x140
  /* 017020 80016420 0121001A */       div $zero, $t1, $at
  /* 017024 80016424 00005012 */      mflo $t2
  /* 017028 80016428 01077021 */      addu $t6, $t0, $a3
  /* 01702C 8001642C 00E86823 */      subu $t5, $a3, $t0
  /* 017030 80016430 014F0019 */     multu $t2, $t7
  /* 017034 80016434 00C5F821 */      addu $ra, $a2, $a1
  /* 017038 80016438 AFAE0018 */        sw $t6, 0x18($sp)
  /* 01703C 8001643C 3C028004 */       lui $v0, %hi(gCurrScreenHeight)
  /* 017040 80016440 3C188004 */       lui $t8, %hi(D_8003B930)
  /* 017044 80016444 3C198004 */       lui $t9, %hi(D_8003B93C)
  /* 017048 80016448 3C0F8004 */       lui $t7, %hi(D_8003B934)
  /* 01704C 8001644C 00005812 */      mflo $t3
  /* 017050 80016450 018B082A */       slt $at, $t4, $t3
  /* 017054 80016454 10200002 */      beqz $at, .L80016460
  /* 017058 80016458 00000000 */       nop 
  /* 01705C 8001645C 01606025 */        or $t4, $t3, $zero
  .L80016460:
  /* 017060 80016460 8C42667C */        lw $v0, %lo(gCurrScreenHeight)($v0)
  /* 017064 80016464 240100F0 */     addiu $at, $zero, 0xf0
  /* 017068 80016468 8F18B930 */        lw $t8, %lo(D_8003B930)($t8)
  /* 01706C 8001646C 0041001A */       div $zero, $v0, $at
  /* 017070 80016470 00002012 */      mflo $a0
  /* 017074 80016474 448C2000 */      mtc1 $t4, $f4
  /* 017078 80016478 8FA70018 */        lw $a3, 0x18($sp)
  /* 01707C 8001647C 00980019 */     multu $a0, $t8
  /* 017080 80016480 468021A0 */   cvt.s.w $f6, $f4
  /* 017084 80016484 00002812 */      mflo $a1
  /* 017088 80016488 01A5082A */       slt $at, $t5, $a1
  /* 01708C 8001648C 10200002 */      beqz $at, .L80016498
  /* 017090 80016490 00000000 */       nop 
  /* 017094 80016494 00A06825 */        or $t5, $a1, $zero
  .L80016498:
  /* 017098 80016498 8F39B93C */        lw $t9, %lo(D_8003B93C)($t9)
  /* 01709C 8001649C 448D8000 */      mtc1 $t5, $f16
  /* 0170A0 800164A0 01590019 */     multu $t2, $t9
  /* 0170A4 800164A4 468084A0 */   cvt.s.w $f18, $f16
  /* 0170A8 800164A8 00007012 */      mflo $t6
  /* 0170AC 800164AC 012E2823 */      subu $a1, $t1, $t6
  /* 0170B0 800164B0 00BF082A */       slt $at, $a1, $ra
  /* 0170B4 800164B4 10200002 */      beqz $at, .L800164C0
  /* 0170B8 800164B8 00000000 */       nop 
  /* 0170BC 800164BC 00A0F825 */        or $ra, $a1, $zero
  .L800164C0:
  /* 0170C0 800164C0 8DEFB934 */        lw $t7, %lo(D_8003B934)($t7)
  /* 0170C4 800164C4 008F0019 */     multu $a0, $t7
  /* 0170C8 800164C8 0000C012 */      mflo $t8
  /* 0170CC 800164CC 00582823 */      subu $a1, $v0, $t8
  /* 0170D0 800164D0 00A7082A */       slt $at, $a1, $a3
  /* 0170D4 800164D4 50200003 */      beql $at, $zero, .L800164E4
  /* 0170D8 800164D8 3C014080 */       lui $at, 0x4080
  /* 0170DC 800164DC 00A03825 */        or $a3, $a1, $zero
  /* 0170E0 800164E0 3C014080 */       lui $at, (0x40800000 >> 16) # 4.0
  .L800164E4:
  /* 0170E4 800164E4 44810000 */      mtc1 $at, $f0 # 4.0 to cop1
  /* 0170E8 800164E8 3C01ED00 */       lui $at, 0xed00
  /* 0170EC 800164EC 00601025 */        or $v0, $v1, $zero
  /* 0170F0 800164F0 46003202 */     mul.s $f8, $f6, $f0
  /* 0170F4 800164F4 24630008 */     addiu $v1, $v1, 8
  /* 0170F8 800164F8 00602025 */        or $a0, $v1, $zero
  /* 0170FC 800164FC 46009102 */     mul.s $f4, $f18, $f0
  /* 017100 80016500 24630008 */     addiu $v1, $v1, 8
  /* 017104 80016504 00602825 */        or $a1, $v1, $zero
  /* 017108 80016508 24630008 */     addiu $v1, $v1, 8
  /* 01710C 8001650C 00603025 */        or $a2, $v1, $zero
  /* 017110 80016510 24630008 */     addiu $v1, $v1, 8
  /* 017114 80016514 4600428D */ trunc.w.s $f10, $f8
  /* 017118 80016518 449F4000 */      mtc1 $ra, $f8
  /* 01711C 8001651C 4600218D */ trunc.w.s $f6, $f4
  /* 017120 80016520 440E5000 */      mfc1 $t6, $f10
  /* 017124 80016524 44872000 */      mtc1 $a3, $f4
  /* 017128 80016528 468042A0 */   cvt.s.w $f10, $f8
  /* 01712C 8001652C 31CF0FFF */      andi $t7, $t6, 0xfff
  /* 017130 80016530 000FC300 */       sll $t8, $t7, 0xc
  /* 017134 80016534 440F3000 */      mfc1 $t7, $f6
  /* 017138 80016538 0301C825 */        or $t9, $t8, $at
  /* 01713C 8001653C 468021A0 */   cvt.s.w $f6, $f4
  /* 017140 80016540 46005402 */     mul.s $f16, $f10, $f0
  /* 017144 80016544 31F80FFF */      andi $t8, $t7, 0xfff
  /* 017148 80016548 03387025 */        or $t6, $t9, $t8
  /* 01714C 8001654C AC4E0000 */        sw $t6, ($v0)
  /* 017150 80016550 3C01FF00 */       lui $at, 0xff00
  /* 017154 80016554 46003202 */     mul.s $f8, $f6, $f0
  /* 017158 80016558 4600848D */ trunc.w.s $f18, $f16
  /* 01715C 8001655C 4600428D */ trunc.w.s $f10, $f8
  /* 017160 80016560 44199000 */      mfc1 $t9, $f18
  /* 017164 80016564 00000000 */       nop 
  /* 017168 80016568 33380FFF */      andi $t8, $t9, 0xfff
  /* 01716C 8001656C 44195000 */      mfc1 $t9, $f10
  /* 017170 80016570 00187300 */       sll $t6, $t8, 0xc
  /* 017174 80016574 33380FFF */      andi $t8, $t9, 0xfff
  /* 017178 80016578 01D87825 */        or $t7, $t6, $t8
  /* 01717C 8001657C AC4F0004 */        sw $t7, 4($v0)
  /* 017180 80016580 3C19E700 */       lui $t9, 0xe700
  /* 017184 80016584 AC990000 */        sw $t9, ($a0)
  /* 017188 80016588 AC800004 */        sw $zero, 4($a0)
  /* 01718C 8001658C 3C0E8004 */       lui $t6, %hi(gPixelComponentSize)
  /* 017190 80016590 8DCE6674 */        lw $t6, %lo(gPixelComponentSize)($t6)
  /* 017194 80016594 00601025 */        or $v0, $v1, $zero
  /* 017198 80016598 31D80003 */      andi $t8, $t6, 3
  /* 01719C 8001659C 3C0E8004 */       lui $t6, %hi(gCurrScreenWidth)
  /* 0171A0 800165A0 8DCE6678 */        lw $t6, %lo(gCurrScreenWidth)($t6)
  /* 0171A4 800165A4 00187CC0 */       sll $t7, $t8, 0x13
  /* 0171A8 800165A8 01E1C825 */        or $t9, $t7, $at
  /* 0171AC 800165AC 25D8FFFF */     addiu $t8, $t6, -1
  /* 0171B0 800165B0 330F0FFF */      andi $t7, $t8, 0xfff
  /* 0171B4 800165B4 032F7025 */        or $t6, $t9, $t7
  /* 0171B8 800165B8 3C180F00 */       lui $t8, 0xf00
  /* 0171BC 800165BC ACB80004 */        sw $t8, 4($a1)
  /* 0171C0 800165C0 ACAE0000 */        sw $t6, ($a1)
  /* 0171C4 800165C4 3C19E300 */       lui $t9, (0xE3000A01 >> 16) # 3808430593
  /* 0171C8 800165C8 37390A01 */       ori $t9, $t9, (0xE3000A01 & 0xFFFF) # 3808430593
  /* 0171CC 800165CC ACD90000 */        sw $t9, ($a2)
  /* 0171D0 800165D0 ACC00004 */        sw $zero, 4($a2)
  /* 0171D4 800165D4 8FAF0038 */        lw $t7, 0x38($sp)
  /* 0171D8 800165D8 3C0EE200 */       lui $t6, (0xE200001C >> 16) # 3791650844
  /* 0171DC 800165DC 24010002 */     addiu $at, $zero, 2
  /* 0171E0 800165E0 11E00003 */      beqz $t7, .L800165F0
  /* 0171E4 800165E4 35CE001C */       ori $t6, $t6, (0xE200001C & 0xFFFF) # 3791650844
  /* 0171E8 800165E8 15E10007 */       bne $t7, $at, .L80016608
  /* 0171EC 800165EC 3C19E200 */       lui $t9, (0xE200001C >> 16) # 3791650844
  .L800165F0:
  /* 0171F0 800165F0 3C180055 */       lui $t8, (0x552078 >> 16) # 5578872
  /* 0171F4 800165F4 37182078 */       ori $t8, $t8, (0x552078 & 0xFFFF) # 5578872
  /* 0171F8 800165F8 AC580004 */        sw $t8, 4($v0)
  /* 0171FC 800165FC 24630008 */     addiu $v1, $v1, 8
  /* 017200 80016600 10000008 */         b .L80016624
  /* 017204 80016604 AC4E0000 */        sw $t6, ($v0)
  .L80016608:
  /* 017208 80016608 00601025 */        or $v0, $v1, $zero
  /* 01720C 8001660C 3C0F0050 */       lui $t7, (0x5049D8 >> 16) # 5261784
  /* 017210 80016610 35EF49D8 */       ori $t7, $t7, (0x5049D8 & 0xFFFF) # 5261784
  /* 017214 80016614 3739001C */       ori $t9, $t9, (0xE200001C & 0xFFFF) # 3791650844
  /* 017218 80016618 AC590000 */        sw $t9, ($v0)
  /* 01721C 8001661C AC4F0004 */        sw $t7, 4($v0)
  /* 017220 80016620 24630008 */     addiu $v1, $v1, 8
  .L80016624:
  /* 017224 80016624 8FAE0030 */        lw $t6, 0x30($sp)
  /* 017228 80016628 ADC30000 */        sw $v1, ($t6)
  /* 01722C 8001662C 8FBF0014 */        lw $ra, 0x14($sp)
  /* 017230 80016630 27BD0030 */     addiu $sp, $sp, 0x30
  /* 017234 80016634 03E00008 */        jr $ra
  /* 017238 80016638 00000000 */       nop 

